Прозрачный буфер таблицы Power Query в локальной БД SQLite с возможностью изменения существующих и дозагрузки новых данных: вы бесплатно получаете инкрементальное обновление на своем Power BI Desktop:
- база SQLite - это единственный файл с любым понятным вам названием и расширением, который можно синхронизировать с другими устройствами с помощью Яндекс диска, Google Drive и т.п.
- для прямого подключения к базе SQLite можно использовать, например, [SQLite ODBC Driver](http://www.ch-werner.de/sqliteodbc/) или скрипт, о котором сейчас идет речь

## Начало работы
1. Скачайте и установите python версии 3.x, если он у вас еще не установлен
1. В настройках Power BI проверьте ссылку на питон File > Options and settings > Options > Python scripting: Detected Python home directories
1. Скопируйте [исходный код скрипта](https://raw.githubusercontent.com/meta110/powerbi/master/sqliteproxy/pbi2sqlite.m) и вставьте его в пустой запрос

Аргумент | Обязательный | Описание
---|---|---
DataBasePath | * | Ссылка на файл базы данных (полный путь, например: C:\Databases\database.sqlite). Если файл не существует, то он будет создан автоматически
TableName | * | Название таблицы. Внутри базы данных может быть несколько таблиц. Если таблица не существует, то она будет создана автоматически
Data | - |  Таблица Power Query, которую нужно поместить в БД. Если указан null, то ничего возвращаться не будет
KeyColumns | - | Ключевые колонки. Список ключевых колонок из переданной таблицы (одна колонка с уникальными значениями или сочетание из нескольких колонок с уникальными значениями). Если таблица не передана ( Data = null ), то этот аргумент игнорируется. Если база не пустая, то список ключевых колонок обязателен.
RaiseError | - | Возбуждать ошибку при несоответствии данных. Если колонки в новой порции данных отличаются от имеющихся в таблице БД, возникнет ошибка. Можно принудительно пересоздать таблицу с новыми данными

## Сообщения о возможных ошибках
Во время работы вы можете столкнуться со следующими ошибками. Текст ошибки может немного отличаться, но смысл тот же самый
Ошибка | Как исправить
---|---
Указан путь к несуществующей папке с БД | Укажите путь к допустимой папке
Не передана никакая таблица с данными и БД не существует | Или передайте данные чтобы создать из них БД, или укажите путь к существующей БД
Колонки в новой порции данных отличаются от существующих в БД | Возможно, вы по ошибке пытаетесь поместить в таблицу данные, предназначенные для другой таблицы. Или укажите другое имя таблицы, или установите параметр RaiseError = false, чтобы существующая таблица была пересоздана с новыми данными
Указанные ключевые колонки отсутствуют в таблице | Вы указали ключевые колонки, которых нет в переданной вами таблице. Проверьте правильно ли указали колонки и сами данные

## Полезные ссылки для работы с SQLite
- [SQLite Studio](https://sqlitestudio.pl/)
- [SQLite ODBC Driver](http://www.ch-werner.de/sqliteodbc/)
